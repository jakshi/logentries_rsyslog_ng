# Generated by Chef for <%= node['fqdn'] %>
# Local modifications will be overwritten.


input(type="imfile"
      File="<%= @log_filename %>"
<% if @rsyslog_tag %>
      Tag="<%= "#{@rsyslog_tag}:" %>"
<% end %>
      StateFile="<%= @state_file %>"
<% if @syslog_facility %>
      Facility="<%= @syslog_facility %>"
<% end %>
<% if @rsyslog_ruleset %>
      Ruleset="<%= @rsyslog_ruleset %>"
<% end %>
)

$template <%= "LogentriesFormat_#{@logentries_name}" %>,"<%= @logentries_token %> <%= @node_identity %> %syslogtag% %msg%\n"

<% if @rsyslog_ruleset %>
ruleset(name="<%= @rsyslog_ruleset %>"){
<% end %>
<%= @rsyslog_selector %> action(type="omfwd" protocol="tcp" Target="api.logentries.com" Port="20000" StreamDriverMode="1" StreamDriver="gtls" StreamDriverAuthMode="x509/name" StreamDriverPermittedPeers="*.logentries.com" template="<%= "LogentriesFormat_#{@logentries_name}" %>")
<% if @rsyslog_ruleset %>
}
<% end %>

