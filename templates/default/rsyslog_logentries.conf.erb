# Generated by Chef for <%= node['fqdn'] %>
# Local modifications will be overwritten.

$InputFileName <%= @log_filename %>
<% if @rsyslog_tag %>
$InputFileTag <%= "#{@rsyslog_tag}:" %>
<% end %>
$InputFileStateFile <%= @state_file %>
<% if @syslog_facility %>
$InputFileFacility <%= @syslog_facility %>
<% end %>
$InputRunFileMonitor

$InputFilePollInterval 10

$template <%= "LogentriesFormat_#{logentries_name}" %>,"<%= @logentries_token %> <%= @node_identity %> %syslogtag% %msg%\n"

<%= @rsyslog_selector %> action(type="omfwd" protocol="tcp" Target="api.logentries.com" Port="20000" StreamDriverMode="1" StreamDriver="gtls" StreamDriverAuthMode="x509/name" StreamDriverPermittedPeers="*.logentries.com" template="<%= "LogentriesFormat_#{logentries_name}" %>")